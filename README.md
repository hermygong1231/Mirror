# 棱镜 — AI 决策复盘小程序

> 通过 AI 驱动的决策复盘，帮助专业人士识别行为原则和认知偏差，从错误中真正进步。

## 产品理念

**棱镜不是心理咨询师，不是来让你感觉更好的——而是让你更清楚。**

- **反自欺**：强制记录决策时的预期，不给事后合理化留空间
- **识别模式**：AI 自动提取行为原则，揭示"你以为你是谁 vs 你真实是谁"
- **持续进化**：通过历史数据积累，发现惯性偏差

## 核心功能

### 决策记录（3 步输入）
1. **决策内容**：描述决策、列出备选方案、选择倾向、AI 智能标签
2. **决策理由**：选择理由、恐惧担忧、情绪状态
3. **预期与复盘**：预期结果、设定复盘周期（1 周 / 1 月 / 3 月 / 6 月）

### AI 复盘分析
- **负面路径**：识别认知偏差（乐观偏差 / 计划谬误 / 确认偏差等），直击错误根源
- **正面路径**：提炼思维优势，把"运气"变成可复用的"能力"
- **破壁反馈**：用户确认分析是否"破壁"，形成闭环

### AI Agent 对话
- 基于腾讯元器的 AI 聊天助手，支持多轮对话、联网搜索
- 三级状态判定：信息不足 → 模糊决策 → 完整去自欺分析

### 其他功能
- 决策列表筛选（全部 / 待复盘 / 已复盘）、搜索、分页
- 左滑删除、重写复盘
- 数据导出（JSON / Markdown）
- 新手引导系统
- 草稿自动保存

## 技术架构

| 层级 | 技术 |
|------|------|
| 前端 | 微信小程序原生（WXML + WXSS + JS） |
| 后端 | 微信云开发（云函数 + 云数据库） |
| AI 主力模型 | DeepSeek R1 |
| AI 降级模型 | 混元 Lite → 本地规则分析 |
| AI Agent | 腾讯元器 |

### AI 三层降级策略
1. **DeepSeek R1**（前端直连）— 主力
2. **混元 Lite** — DeepSeek 不可用时自动降级
3. **本地规则分析** — 大模型全挂时的兜底

## 项目结构

```
├── miniprogram/                 # 小程序前端
│   ├── pages/
│   │   ├── decisions/list       # 决策列表页（首页）
│   │   ├── create/step1~3       # 3 步决策输入
│   │   ├── review/recall        # 复盘回顾
│   │   ├── review/input         # 复盘输入
│   │   ├── review/result        # AI 分析结果
│   │   └── chatBot/chatBot      # AI Agent 聊天
│   └── components/
│       ├── agent-ui/            # 腾讯云 Agent UI 组件
│       └── toolCard/            # 工具卡片组件
├── cloudfunctions/              # 云函数
│   ├── decisionAI/              # AI 分析（标签 + 拆穿分析）
│   └── decisionCRUD/            # 决策 CRUD
└── docs/                        # 产品文档 & 知识库
    ├── plans/                   # 产品设计 & 迭代记录
    └── knowledge/               # 认知偏差百科 & 决策框架
```

## 快速开始

### 环境要求
- [微信开发者工具](https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html)
- Node.js 14+

### 本地运行
1. 克隆仓库
   ```bash
   git clone https://github.com/hermygong1231/Mirror.git
   ```
2. 用微信开发者工具打开项目根目录
3. 在开发者工具中开通云开发，使用环境 ID `cloud1-1grnkl8gbfae008c`
4. 右键 `cloudfunctions` 下的每个云函数目录，选择「上传并部署：云端安装依赖」
5. 在云数据库中创建 `decisions` 集合

## 知识库

项目内置了完整的认知偏差知识体系：
- **认知偏差百科**：15 个核心偏差详解
- **决策框架**：预验尸法、10/10/10 法则等
- **自欺模式库**：常见自我欺骗模式识别

## License

MIT
